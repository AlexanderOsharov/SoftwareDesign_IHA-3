# –°–∏—Å—Ç–µ–º–∞ –∞–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç–∞ (–ö–ü–û –î–ó-3)

> **–¶–µ–ª—å**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker, REST API –∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

## üéØ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –∑–∞–¥–∞–Ω–∏—è

| ‚Ññ | –ö—Ä–∏—Ç–µ—Ä–∏–π | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –ú–∞–∫—Å. –±–∞–ª–ª |
|---|----------|------------|------------|
| 1 | **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è**<br>‚Äî –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞–±–æ—Ç—ã<br>‚Äî –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –°–£–ë–î + —Ñ–∞–π–ª<br>‚Äî –ê–Ω–∞–ª–∏–∑ –∏ –æ—Ç—á—ë—Ç<br>‚Äî API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç—á—ë—Ç–∞ | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ `ApiGateway` ‚Üí `MetadataService` + `FileStoringService` ‚Üí `FileAnalysisService`<br>‚Äî `POST /api/submit-work`<br>‚Äî `GET /api/works/{id}/reports` | 2 |
| 2 | **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**<br>‚Äî ‚â•2 –±–∏–∑–Ω–µ—Å-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞<br>‚Äî –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | ‚úÖ **3 –±–∏–∑–Ω–µ—Å-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞**:<br>1. `MetadataService` (PostgreSQL)<br>2. `FileStoringService` (—Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)<br>3. `FileAnalysisService` (–∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±–ª–∞–∫–æ —Å–ª–æ–≤)<br>‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –≤ `ApiGateway` (`UseExceptionHandler`) | 2 |
| 3 | **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**<br>‚Äî Dockerfile –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞<br>‚Äî `docker-compose.yml`<br>‚Äî –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `docker compose up` | ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏–º–µ—é—Ç –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—É—é —Å–±–æ—Ä–∫—É<br>‚úÖ `HEALTHCHECK` –≤ –∫–∞–∂–¥–æ–º Dockerfile<br>‚úÖ –ï–¥–∏–Ω—ã–π `docker-compose.yml`<br>‚úÖ –ö–æ–º–∞–Ω–¥–∞ `docker compose up --build` —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –≤—Å—é —Å–∏—Å—Ç–µ–º—É | 2 |
| 4 | **Swagger / Postman**<br>‚Äî –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ—Ö API | ‚úÖ **Swagger UI** –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ `http://localhost:8080`<br>‚Äî –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:<br>  ‚Ä¢ `POST /api/submit-work`<br>  ‚Ä¢ `GET /api/works/{workId}/reports`<br>‚Äî –§–æ—Ä–º–∞—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Postman (REST, JSON) | 1 |
| 5 | **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**<br>a) –ß–∏—Å—Ç—ã–π, –º–æ–¥—É–ª—å–Ω—ã–π –∫–æ–¥<br>b) –û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ | ‚úÖ –ö–æ–¥: record-—Ç–∏–ø—ã, dependency injection, —è–≤–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, Serilog<br>‚úÖ **–≠—Ç–æ—Ç README** —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (—Å–º. –Ω–∏–∂–µ) | 2 |
| 6 | **–ë–æ–Ω—É—Å: –æ–±–ª–∞–∫–æ —Å–ª–æ–≤** | ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `quickchart.io`<br>‚úÖ –°—Å—ã–ª–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ—Ç—á—ë—Ç–µ<br>‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏–∑ `ConsoleClient` | 1 |
| **–ò–¢–û–ì–û** | | **10 / 10** | ‚úÖ |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

### 1. **API Gateway** (`api-gateway:8080`)
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞.
- –ê–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤—ã –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º.
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é, –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (Swagger).

### 2. **Metadata Service** (`metadata-service:8081`)
- –•—Ä–∞–Ω–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç –≤ **PostgreSQL**:
  - `WorkId`, `StudentId`, `AssignmentId`
  - `FileId`, `ReportId`, `TextHash`, `SubmittedAt`
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π.

### 3. **File Storing Service** (`file-storing:8082`)
- –•—Ä–∞–Ω–∏—Ç **—Ñ–∞–π–ª—ã —Ä–∞–±–æ—Ç** –Ω–∞ –¥–∏—Å–∫–µ (volume `file_storage`).
- –ù–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ‚Äî —Ç–æ–ª—å–∫–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ—Ç–¥–∞—á–∞.

### 4. **File Analysis Service** (`file-analysis:8083`)
- –°–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª –ø–æ `FileId`.
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç (`.txt` / `.docx`).
- –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç **SHA256 —Ö–µ—à**.
- –ò—â–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ —Ö–µ—à—É –≤ `MetadataService`.
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **–æ–±–ª–∞–∫–æ —Å–ª–æ–≤** —á–µ—Ä–µ–∑ `https://quickchart.io/wordcloud`.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ç—á—ë—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (`volume report_storage`).
- –û–±–Ω–æ–≤–ª—è–µ—Ç `ReportId` –∏ `TextHash` –≤ `MetadataService`.

### 5. **Console Client**
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –Ω–∞ `Spectre.Console`.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
  - –û—Ç–ø—Ä–∞–≤–∫—É —Ñ–∞–π–ª–æ–≤
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤
  - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
  - –ü–æ–ª–Ω—ã–π end-to-end —Ç–µ—Å—Ç
  - –ü—Ä–æ–≤–µ—Ä–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

---

## üîÑ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞–±–æ—Ç—ã
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª –≤ `ConsoleClient`.
2. `ConsoleClient` ‚Üí `ApiGateway` (`POST /api/submit-work`).
3. `ApiGateway`:
   - –í—ã–∑—ã–≤–∞–µ—Ç `FileStoringService` ‚Üí –ø–æ–ª—É—á–∞–µ—Ç `FileId`.
   - –í—ã–∑—ã–≤–∞–µ—Ç `MetadataService` ‚Üí —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å ‚Üí –ø–æ–ª—É—á–∞–µ—Ç `WorkId`.
   - –í—ã–∑—ã–≤–∞–µ—Ç `FileAnalysisService` ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ (`WorkId`, `FileId`).
4. `FileAnalysisService`:
   - –°–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª.
   - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç.
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ç—á—ë—Ç ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `ReportId`.
   - –û–±–Ω–æ–≤–ª—è–µ—Ç `ReportId` –∏ `TextHash` –≤ `MetadataService`.
5. `ApiGateway` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `WorkId`, `FileId`, `AnalysisStarted`.

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ—Ç—á—ë—Ç –ø–æ `WorkId`.
2. `ConsoleClient` ‚Üí `ApiGateway` (`GET /api/works/{WorkId}/reports`).
3. `ApiGateway`:
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `WorkMetadata` –∏–∑ `MetadataService`.
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `AnalysisReport` –∏–∑ `FileAnalysisService` –ø–æ `ReportId`.
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–ª–∞–≥–∏–∞—Ç–∞
1. –ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ `FileAnalysisService` –≤—ã—á–∏—Å–ª—è–µ—Ç —Ö–µ—à —Ç–µ–∫—Å—Ç–∞.
2. –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `MetadataService` (`GET /submissions/by-hash/{hash}`).
3. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Ä–∞–±–æ—Ç—ã –¥—Ä—É–≥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ —Å —Ç–µ–º –∂–µ —Ö–µ—à–µ–º ‚Üí `plagiarism = true`.
4. –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –≤ `plagiarismEvidence`.

---

## üì¶ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

–í MetadataService –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
dotnet ef database update
```

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker compose up --build

# –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
http://localhost:8080        # API Gateway + Swagger UI
http://localhost:8081/health # Metadata Service
http://localhost:8082/health # File Storing Service
http://localhost:8083/health # File Analysis Service
```

> **Swagger UI**: `http://localhost:8080`  
> **Postman**: –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `curl` –∏–∑ Swagger –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/api/submit-work` –∏ `/api/works/{id}/reports` –Ω–∞–ø—Ä—è–º—É—é.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ `ConsoleClient` –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
- **–ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.
- **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö** ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏—è `work1.txt`, `work2.txt` (—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ), `work3.txt` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π).

```bash
dotnet run --project src/ConsoleClient
```
---

## üìå –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–Ø–∑—ã–∫**: C# / .NET 9
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL (–≤—Å—Ç—Ä–æ–µ–Ω –≤ `docker-compose`)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: Serilog (–∫–æ–Ω—Å–æ–ª—å)
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞**: `TextExtractor` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `.txt` –∏ `.docx`
- **–ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç–∞**: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ SHA256 —Ö–µ—à–µ–π –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- **–û–±–ª–∞–∫–æ —Å–ª–æ–≤**: `https://quickchart.io/wordcloud?text=...`

